<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Travel Matchmaker</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="container py-4">

    <h1 class="mb-4">Travel Matchmaker</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <!-- User form -->
    <form method="POST" class="mb-4">
        <div class="row">
            <div class="col-md-6">
                <label class="form-label">Name</label>
                <input type="text" name="name" class="form-control" required>

                <label class="form-label mt-2">Age</label>
                <input type="number" name="age" class="form-control">

                <label class="form-label mt-2">Gender</label>
                <input type="text" name="gender" class="form-control">

                <label class="form-label mt-2">Location</label>
                <input type="text" name="location" class="form-control">

                <label class="form-label mt-2">Country</label>
                <input type="text" name="country" class="form-control">

                <label class="form-label mt-2">Occupation</label>
                <input type="text" name="occupation" class="form-control">
            </div>

            <div class="col-md-6">
                <label class="form-label">Interests (comma-separated)</label>
                <input type="text" name="interests" class="form-control">

                <label class="form-label mt-2">Languages (comma-separated)</label>
                <input type="text" name="languages" class="form-control">

                <label class="form-label mt-2">Bio</label>
                <textarea name="bio" class="form-control"></textarea>

                <label class="form-label mt-2">Openness (1–10)</label>
                <input type="number" name="openness" class="form-control" min="1" max="10">

                <label class="form-label mt-2">Extraversion (1–10)</label>
                <input type="number" name="extraversion" class="form-control" min="1" max="10">

                <label class="form-label mt-2">Agreeableness (1–10)</label>
                <input type="number" name="agreeableness" class="form-control" min="1" max="10">

                <label class="form-label mt-2">Conscientiousness (1–10)</label>
                <input type="number" name="conscientiousness" class="form-control" min="1" max="10">
            </div>
        </div>

        <button type="submit" class="btn btn-primary mt-3">Find Matches</button>
    </form>

    <!-- Matches list -->
    {% if matches %}
        <h2>Matches Found</h2>
        <ul class="list-group">
        {% for match in matches %}
            <li class="list-group-item">
                <strong>{{ match.get('name', 'Unknown') }}</strong>
                — Compatibility: {{ (match.get('compatibility_score', 0) * 100) | round(2) }}%
                <br>
                <small>{{ match.get('explanation', '') }}</small>
                <br>
                {% if match.get('id') and user and user.get('id') %}
                    <a href="{{ url_for('connect', user_id=user['id'], match_id=match['id']) }}"
                       class="btn btn-success btn-sm mt-2">Connect</a>
                {% endif %}
            </li>
        {% endfor %}
        </ul>
    {% elif matches is not none %}
        <p>No matches found.</p>
    {% endif %}

</body>
</html>
